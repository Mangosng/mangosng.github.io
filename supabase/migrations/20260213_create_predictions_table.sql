-- Create predictions table
create table if not exists predictions (
  id bigint generated by default as identity primary key,
  ticker text not null,
  predicted_date date not null,
  predicted_log_return float8 not null,
  predicted_direction int not null, -- +1 or -1
  actual_log_return float8, -- null until the day happens
  actual_direction int, -- null until the day happens
  is_correct boolean, -- calculated later
  confidence_score float8, -- optional, from model features
  created_at timestamp with time zone default timezone('utc'::text, now()) not null,
  unique (ticker, predicted_date)
);

-- Enable RLS
alter table predictions enable row level security;
create policy "Public read access" on predictions for select using (true);
create policy "Service role write access" on predictions for insert, update using (true);
